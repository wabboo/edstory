(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{lmR2:function(e,t,s){"use strict";s.r(t),s.d(t,"MenuModule",(function(){return Z}));var n=s("ofXK"),r=s("IVc4"),i=s("fXoL");let c=(()=>{class e{}return e.\u0275mod=i.Kb({type:e}),e.\u0275inj=i.Jb({factory:function(t){return new(t||e)},imports:[[n.b,r.a]]}),e})();var o=s("tyNb");let a=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Gb({type:e,selectors:[["app-menu"]],decls:1,vars:0,template:function(e,t){1&e&&i.Nb(0,"router-outlet")},directives:[o.d],styles:["[_nghost-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column;height:100%;justify-content:center;align-items:center;background:url(/edstory/assets/backgrounds/main2.jpg);background-size:cover}"]}),e})();var h=s("4A+J"),u=s("OcQ2"),d=s("OEjf"),l=s("eihG");function g(e,t){1&e&&i.Nb(0,"ed-icon",3)}function m(e,t){1&e&&i.Nb(0,"ed-icon",4)}const p=["*"];let b=(()=>{class e{constructor(){this.state="active",this.checkedChange=new i.n}get checked(){return this.checkedValue}set checked(e){this.checkedValue=e,this.checkedChange.emit(e)}ngOnInit(){}getCssClass(){let e=" checked";switch(this.checkedValue||(e=" unchecked"),this.state){case"active":return"container active"+e;case"selected":return"container selected"+e;case"disabled":return"container disabled"+e;case"blocked":return"container blocked"+e}}onClick(){"active"===this.state&&(this.checked=!this.checked)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Gb({type:e,selectors:[["ed-check"]],inputs:{state:"state",checked:"checked"},outputs:{checkedChange:"checkedChange"},ngContentSelectors:p,decls:4,vars:3,consts:[[3,"ngClass","click"],["icon","checked","size","3",4,"ngIf"],["icon","unchecked","size","3",4,"ngIf"],["icon","checked","size","3"],["icon","unchecked","size","3"]],template:function(e,t){1&e&&(i.gc(),i.Sb(0,"div",0),i.Zb("click",(function(){return t.onClick()})),i.sc(1,g,1,0,"ed-icon",1),i.sc(2,m,1,0,"ed-icon",2),i.fc(3),i.Rb()),2&e&&(i.hc("ngClass",t.getCssClass()),i.Bb(1),i.hc("ngIf",t.checked),i.Bb(1),i.hc("ngIf",!t.checked))},directives:[n.h,n.j,l.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;margin-bottom:4px}.container[_ngcontent-%COMP%]{box-sizing:border-box;height:4vh;display:flex;flex-direction:row;align-items:center;padding-left:.5vw;font-size:1.7vh}ed-icon[_ngcontent-%COMP%]{margin-right:8px}.checked[_ngcontent-%COMP%]{color:#ff6105;stroke:#ff6105}.unchecked[_ngcontent-%COMP%]{color:rgba(187,44,0,.7);stroke:rgba(187,44,0,.7)}.active[_ngcontent-%COMP%]{background:rgba(64,8,0,.55)}.container.active[_ngcontent-%COMP%]:hover{background:#f07b05;color:rgba(54,14,0,.95)}.selected[_ngcontent-%COMP%]{background:rgba(175,16,0,.5);color:#ff6105;border-right:8px solid #ff6105}.container.selected[_ngcontent-%COMP%]:hover{background:#f07b05;color:rgba(54,14,0,.95)}.disabled[_ngcontent-%COMP%]{background:rgba(48,48,48,.69);color:#fff;stroke:#fff;fill:#fff}.blocked[_ngcontent-%COMP%]{background:rgba(56,0,0,.38);color:#8e0000;stroke:#8e0000;fill:#8e0000}.container.blocked[_ngcontent-%COMP%]:hover{background:#8e0000;color:#000;stroke:#000;fill:#000}"]}),e})();var f=s("65hZ"),k=s("UNDe"),v=s("qO2F"),w=s("F/yl");let y=(()=>{class e{constructor(e,t,s){this.router=e,this.route=t,this.commanderService=s,this.commanderService.features.subscribe(e=>{this.features=e})}ngOnInit(){}updateFeatures(){this.commanderService.features.next(this.features)}onBack(){history.back()}onNavigateExperiment(e){this.router.navigate(["experiments",e],{relativeTo:this.route})}}return e.\u0275fac=function(t){return new(t||e)(i.Mb(o.b),i.Mb(o.a),i.Mb(h.a))},e.\u0275cmp=i.Gb({type:e,selectors:[["ng-component"]],decls:34,vars:8,consts:[[1,"columns"],["state","blocked",3,"checked","checkedChange"],[3,"checked","checkedChange"],[3,"press"],["name","The Grid",3,"press"],["name","WebGL space viewer",3,"press"]],template:function(e,t){1&e&&(i.Sb(0,"ed-window"),i.Sb(1,"div",0),i.Sb(2,"ed-column"),i.Sb(3,"h1"),i.uc(4,"Updates"),i.Rb(),i.Sb(5,"ed-check",1),i.Zb("checkedChange",(function(e){return t.features.odyssey=e}))("checkedChange",(function(){return t.updateFeatures()})),i.uc(6,"Odyssey"),i.Rb(),i.Sb(7,"ed-check",2),i.Zb("checkedChange",(function(e){return t.features.fleetCarriers=e}))("checkedChange",(function(){return t.updateFeatures()})),i.uc(8,"Fleet carriers"),i.Rb(),i.Nb(9,"ed-frame-spacer"),i.Sb(10,"h1"),i.uc(11,"Alterations"),i.Rb(),i.Sb(12,"ed-check",2),i.Zb("checkedChange",(function(e){return t.features.corporations=e}))("checkedChange",(function(){return t.updateFeatures()})),i.uc(13,"Corporations"),i.Rb(),i.Sb(14,"ed-check",2),i.Zb("checkedChange",(function(e){return t.features.altNavigationPanel=e}))("checkedChange",(function(){return t.updateFeatures()})),i.uc(15,"Alternative navigation panel"),i.Rb(),i.Sb(16,"ed-check",1),i.Zb("checkedChange",(function(e){return t.features.advisors=e}))("checkedChange",(function(){return t.updateFeatures()})),i.uc(17,"Advisors"),i.Rb(),i.Sb(18,"ed-check",1),i.Zb("checkedChange",(function(e){return t.features.passengerLines=e}))("checkedChange",(function(){return t.updateFeatures()})),i.uc(19,"Passenger lines"),i.Rb(),i.Sb(20,"ed-check",1),i.Zb("checkedChange",(function(e){return t.features.mechanic=e}))("checkedChange",(function(){return t.updateFeatures()})),i.uc(21,"Mechanic"),i.Rb(),i.Sb(22,"ed-check",1),i.Zb("checkedChange",(function(e){return t.features.restructuredShipPanels=e}))("checkedChange",(function(){return t.updateFeatures()})),i.uc(23,"Restructured internal/external panels"),i.Rb(),i.Nb(24,"ed-frame-filler"),i.Sb(25,"ed-button",3),i.Zb("press",(function(){return t.onBack()})),i.uc(26,"Back to ship"),i.Rb(),i.Rb(),i.Nb(27,"ed-frame-spacer"),i.Sb(28,"ed-column"),i.Sb(29,"h1"),i.uc(30,"Experiments"),i.Rb(),i.Sb(31,"ed-tile",4),i.Zb("press",(function(){return t.onNavigateExperiment("thegrid")})),i.Rb(),i.Nb(32,"ed-frame-spacer"),i.Sb(33,"ed-tile",5),i.Zb("press",(function(){return t.onNavigateExperiment("space")})),i.Rb(),i.Rb(),i.Rb(),i.Rb()),2&e&&(i.Bb(5),i.hc("checked",t.features.odyssey),i.Bb(2),i.hc("checked",t.features.fleetCarriers),i.Bb(5),i.hc("checked",t.features.corporations),i.Bb(2),i.hc("checked",t.features.altNavigationPanel),i.Bb(2),i.hc("checked",t.features.advisors),i.Bb(2),i.hc("checked",t.features.passengerLines),i.Bb(2),i.hc("checked",t.features.mechanic),i.Bb(2),i.hc("checked",t.features.restructuredShipPanels))},directives:[u.a,d.a,b,f.a,k.a,v.a,w.a],styles:["[_nghost-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column;width:100%}.columns[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;flex-direction:row}ed-column[_ngcontent-%COMP%]{flex:50%}h1[_ngcontent-%COMP%]{padding:1vh}"]}),e})();var S=s("krhP"),C=s("U6jI");const M=[[["ed-grid-layer"]]],x=["ed-grid-layer"];let O=(()=>{class e{constructor(e){this.gamepadService=e,this.resolutionX=20,this.resolutionY=15,this.cursorX=0,this.cursorY=0,this.gamepadService.controller1.subscribe(e=>{e.dPadLeft===S.a.Click&&(this.cursorX-=1,this.cursorX<0&&(this.cursorX=0)),e.dPadRight===S.a.Click&&(this.cursorX+=1,this.cursorX>=this.resolutionX&&(this.cursorX=this.resolutionX-1)),e.dPadUp===S.a.Click&&(this.cursorY-=1,this.cursorY<0&&(this.cursorY=0)),e.dPadDown===S.a.Click&&(this.cursorY+=1,this.cursorY>=this.resolutionY&&(this.cursorY=this.resolutionY-1))})}ngOnInit(){this.backgroundSize=this.getWidth()+" "+this.getHeight()}getWidth(e=1){return 100/this.resolutionX*e+"% "}getHeight(e=1){return 100/this.resolutionY*e+"%"}getTop(e){return e*(100/this.resolutionY)+"%"}getLeft(e){return e*(100/this.resolutionX)+"%"}onMouseMove(e){if(e.target instanceof HTMLElement){const t=e.target.clientHeight;this.cursorX=Math.floor(e.offsetX/(e.target.clientWidth/this.resolutionX)),this.cursorY=Math.floor(e.offsetY/(t/this.resolutionY)),this.cursorX<0&&(this.cursorX=0),this.cursorY<0&&(this.cursorY=0),this.cursorX>=this.resolutionX&&(this.cursorX=this.resolutionX-1),this.cursorY>=this.resolutionY&&(this.cursorY=this.resolutionY-1)}}}return e.\u0275fac=function(t){return new(t||e)(i.Mb(C.a))},e.\u0275cmp=i.Gb({type:e,selectors:[["ed-grid"]],inputs:{resolutionX:"resolutionX",resolutionY:"resolutionY"},ngContentSelectors:x,decls:4,vars:10,consts:[[1,"container",3,"mousemove"],[1,"raster"],[1,"cursor"]],template:function(e,t){1&e&&(i.gc(M),i.Sb(0,"div",0),i.Zb("mousemove",(function(e){return t.onMouseMove(e)})),i.Nb(1,"div",1),i.Nb(2,"div",2),i.fc(3),i.Rb()),2&e&&(i.Bb(1),i.rc("background-size",t.backgroundSize),i.Bb(1),i.rc("top",t.getTop(t.cursorY))("left",t.getLeft(t.cursorX))("width",t.getWidth())("height",t.getHeight()))},styles:["[_nghost-%COMP%]{display:flex;flex:0 0 auto;flex-direction:column;height:100%}.container[_ngcontent-%COMP%]{position:relative;border:1px solid rgba(187,44,0,.5)}.container[_ngcontent-%COMP%], .raster[_ngcontent-%COMP%]{width:100%;height:100%}.raster[_ngcontent-%COMP%]{top:0;left:0;background-image:linear-gradient(90deg,rgba(187,44,0,.5) 1px,transparent 0),linear-gradient(180deg,rgba(187,44,0,.5) 1px,transparent 0)}.cursor[_ngcontent-%COMP%], .raster[_ngcontent-%COMP%]{position:absolute}.cursor[_ngcontent-%COMP%]{width:5%;height:5%;background:#f07b05}"]}),e})();function P(e,t){if(1&e){const e=i.Tb();i.Sb(0,"div",1),i.Zb("mousemove",(function(t){return i.nc(e),i.cc().onMouseMove(t)})),i.uc(1),i.Rb()}if(2&e){const e=t.$implicit,s=i.cc();i.rc("left",s.grid.getLeft(e.x))("top",s.grid.getTop(e.y))("width",s.grid.getWidth(e.width))("height",s.grid.getHeight(e.height)),i.Bb(1),i.wc(" ",e.name,"\n")}}class X{constructor(e,t,s,n,r){this.x=e,this.y=t,this.width=s,this.height=n,this.name=r}}let Y=(()=>{class e{constructor(e){this.grid=e,this.elements=[]}ngOnInit(){this.elements.push(new X(2,2,2,2,"Element 1")),this.elements.push(new X(5,5,4,4,"Element 2")),this.elements.push(new X(10,5,6,4,"Element 3"))}onMouseMove(e){e.stopPropagation()}}return e.\u0275fac=function(t){return new(t||e)(i.Mb(O))},e.\u0275cmp=i.Gb({type:e,selectors:[["ed-grid-layer"]],inputs:{name:"name"},decls:1,vars:1,consts:[["class","block",3,"left","top","width","height","mousemove",4,"ngFor","ngForOf"],[1,"block",3,"mousemove"]],template:function(e,t){1&e&&i.sc(0,P,2,9,"div",0),2&e&&i.hc("ngForOf",t.elements)},directives:[n.i],styles:["[_nghost-%COMP%]{top:0;left:0;width:100%;height:100%}.block[_ngcontent-%COMP%], [_nghost-%COMP%]{position:absolute}.block[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;background:rgba(64,8,0,.55);border:1px solid rgba(187,44,0,.5);font-size:1vw}"]}),e})(),_=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Gb({type:e,selectors:[["ng-component"]],decls:4,vars:0,consts:[["resolutionX","20","resolutionY","15"],["name","Power"],["name","Heat"]],template:function(e,t){1&e&&(i.Sb(0,"ed-window"),i.Sb(1,"ed-grid",0),i.Nb(2,"ed-grid-layer",1),i.Nb(3,"ed-grid-layer",2),i.Rb(),i.Rb())},directives:[u.a,O,Y],styles:["[_nghost-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column;width:100%}"]}),e})();var E=s("vHk7"),R=s("Womt");let z=(()=>{class e{constructor(e){this.element=e,this.loader=new R.b,this.renderer=new R.l,this.scene=new R.i,this.camera=new R.g(60,window.innerWidth/window.innerHeight,1e-4,1e6),this.hud=new R.f}ngOnInit(){this.element.nativeElement.appendChild(this.renderer.domElement),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setAnimationLoop(()=>{this.renderFrame()}),this.camera.position.z=100,this.camera.position.y=-150,this.camera.rotation.x=1,this.scene.background=this.loader.load(["assets/backgrounds/space.jpg","assets/backgrounds/space.jpg","assets/backgrounds/space.jpg","assets/backgrounds/space.jpg","assets/backgrounds/space.jpg","assets/backgrounds/space.jpg"])}ngOnDestroy(){this.scene.dispose(),this.renderer.dispose()}onResize(e){this.renderer.setSize(window.innerWidth,window.innerHeight),this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix()}resetViewport(e){this.scene.children=[],e.linkToScene(this.scene)}applyGamepadStateToMapCamera(e){const t=new R.k;this.camera.getWorldDirection(t),t.z=0,this.camera.position.addScaledVector(t,e.leftStickAxisY*(5/this.camera.zoom)),t.applyAxisAngle(new R.k(0,0,1),.5*Math.PI),this.camera.position.addScaledVector(t,5/this.camera.zoom*-e.leftStickAxisX),this.camera.rotateOnWorldAxis(new R.k(0,0,1),-e.rightStickAxisX/(50*this.camera.zoom)),this.camera.rotateOnWorldAxis(t,-e.rightStickAxisY/(50*this.camera.zoom)),e.leftTrigger&&(this.camera.zoom=1,this.camera.updateProjectionMatrix()),e.rightTrigger&&(this.camera.zoom+=this.camera.zoom/50,this.camera.updateProjectionMatrix())}renderFrame(){this.tick=Date.now(),this.run(this.tick),this.renderer.render(this.scene,this.camera)}updateHud(){this.hud.children=[];const e=new R.h(5,5,1,1),t=new R.e({color:"blue",opacity:.5,transparent:!0,side:R.c}),s=new R.d(e,t);this.hud.add(s);const n=new R.k,r=new R.k;this.camera.getWorldDirection(n),this.camera.getWorldPosition(r),this.hud.position.copy(this.camera.position),this.hud.position.addScaledVector(n,5),this.hud.rotation.copy(this.camera.rotation)}}return e.\u0275fac=function(t){return new(t||e)(i.Mb(i.l))},e.\u0275dir=i.Hb({type:e,hostBindings:function(e,t){1&e&&i.Zb("resize",(function(e){return t.onResize(e)}),!1,i.mc)}}),e})();class H{applyMouse(e,t){this.deltaX=e.clientX-this.x,this.deltaY=e.clientY-this.y,this.x=e.clientX,this.y=e.clientY,(this.deltaX||this.deltaY)&&(this.userInput=!0)}applyWheel(e,t){this.deltaZ=e.deltaY,this.deltaZ&&(this.userInput=!0)}}var I=s("PqYM");let j=(()=>{class e{constructor(){this.state=new i.n,this.keyMouseState=new H,this.tick=0}attach(e){this.domElement&&(this.domElement.removeEventListener("mousemove",e=>{this.mouseHandler(e)}),this.domElement.removeEventListener("mousedown",e=>{this.mouseHandler(e)}),this.domElement.removeEventListener("mouseup",e=>{this.mouseHandler(e)}),this.domElement.removeEventListener("wheel",e=>{this.wheelHandler(e)})),this.domElement=e,this.domElement.addEventListener("mousemove",e=>{this.mouseHandler(e)}),this.domElement.addEventListener("mousedown",e=>{this.mouseHandler(e)}),this.domElement.addEventListener("mouseup",e=>{this.mouseHandler(e)}),this.domElement.addEventListener("wheel",e=>{this.wheelHandler(e)}),this.processState()}mouseHandler(e){this.keyMouseState.applyMouse(e,this.tick)}wheelHandler(e){this.keyMouseState.applyWheel(e,this.tick)}processState(){this.tick+=1,this.keyMouseState.userInput&&(this.state.emit(this.keyMouseState),this.keyMouseState.userInput=!1),Object(I.a)(16.67).subscribe(()=>this.processState())}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),N=(()=>{class e extends z{constructor(e,t,s){super(e),this.gamepadService=t,this.keyMouseService=s,this.mode="map",this.keyMouseService.attach(e.nativeElement),this.keyMouseService.state.subscribe(e=>{}),this.gamepadService.controller1.subscribe(e=>{switch(this.mode){case"map":this.applyGamepadStateToMapCamera(e)}})}get starSystem(){return this.$starSystem}set starSystem(e){this.$starSystem=e,this.$starSystem&&this.resetViewport(this.$starSystem)}run(e){this.starSystem&&this.starSystem.run(e)}}return e.\u0275fac=function(t){return new(t||e)(i.Mb(i.l),i.Mb(C.a),i.Mb(j))},e.\u0275cmp=i.Gb({type:e,selectors:[["space-viewport-system"]],inputs:{mode:"mode",starSystem:"starSystem"},features:[i.yb],decls:0,vars:0,template:function(e,t){},styles:["[_nghost-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden}"]}),e})();const L=[{path:"",component:a,children:[{path:"",component:y},{path:"experiments/thegrid",component:_},{path:"experiments/space",component:(()=>{class e{constructor(e){this.spaceService=e,this.spaceService.getStarSystem("okinura").subscribe(e=>{this.starSystem=e})}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(i.Mb(E.a))},e.\u0275cmp=i.Gb({type:e,selectors:[["ng-component"]],decls:1,vars:1,consts:[[3,"starSystem"]],template:function(e,t){1&e&&i.Nb(0,"space-viewport-system",0),2&e&&i.hc("starSystem",t.starSystem)},directives:[N],styles:[""]}),e})()}]}];let W=(()=>{class e{}return e.\u0275mod=i.Kb({type:e}),e.\u0275inj=i.Jb({factory:function(t){return new(t||e)},imports:[[o.c.forChild(L)],o.c]}),e})(),Z=(()=>{class e{}return e.\u0275mod=i.Kb({type:e}),e.\u0275inj=i.Jb({factory:function(t){return new(t||e)},imports:[[n.b,c,r.a,W]]}),e})()}}]);