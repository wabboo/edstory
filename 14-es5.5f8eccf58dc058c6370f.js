function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=_superPropBase(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,i=_getPrototypeOf(e);if(t){var r=_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _createForOfIteratorHelper(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{lmR2:function(e,t,n){"use strict";n.r(t),n.d(t,"MenuModule",(function(){return N}));var i,r,s,o=n("ofXK"),a=n("IVc4"),c=n("fXoL"),u=((i=function e(){_classCallCheck(this,e)}).\u0275mod=c.Jb({type:i}),i.\u0275inj=c.Ib({factory:function(e){return new(e||i)},imports:[[o.b,a.a]]}),i),l=n("tyNb"),h=((s=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||s)},s.\u0275cmp=c.Fb({type:s,selectors:[["app-menu"]],decls:1,vars:0,template:function(e,t){1&e&&c.Mb(0,"router-outlet")},directives:[l.e],styles:["[_nghost-%COMP%]{display:flex;flex:1 1 auto;flex-direction:row;justify-content:center;align-items:center;background:url(/edstory/assets/backgrounds/main2.jpg);background-size:cover}"]}),s),d=((r=function(){function e(t,n){_classCallCheck(this,e),this.router=t,this.route=n}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"onClick",value:function(e){this.router.navigate([e],{relativeTo:this.route})}}]),e}()).\u0275fac=function(e){return new(e||r)(c.Lb(l.b),c.Lb(l.a))},r.\u0275cmp=c.Fb({type:r,selectors:[["ng-component"]],decls:21,vars:0,consts:[[1,"destination",3,"click"],[1,"image","ship"],[1,"textbox"],[1,"title"],[1,"description"],[1,"image","settings"],[1,"image","playground"]],template:function(e,t){1&e&&(c.Rb(0,"div",0),c.Yb("click",(function(){return t.onClick("/ship/center")})),c.Mb(1,"div",1),c.Rb(2,"div",2),c.Rb(3,"div",3),c.uc(4,"Ship"),c.Qb(),c.Rb(5,"div",4),c.uc(6," Enter a simulated ship of Elite: Dangerous. "),c.Qb(),c.Qb(),c.Qb(),c.Rb(7,"div",0),c.Yb("click",(function(){return t.onClick("/tinkering")})),c.Mb(8,"div",5),c.Rb(9,"div",2),c.Rb(10,"div",3),c.uc(11,"Settings"),c.Qb(),c.Rb(12,"div",4),c.uc(13," Turn on/off various alterations to the ship interface. "),c.Qb(),c.Qb(),c.Qb(),c.Rb(14,"div",0),c.Yb("click",(function(){return t.onClick("/playground")})),c.Mb(15,"div",6),c.Rb(16,"div",2),c.Rb(17,"div",3),c.uc(18,"Playground"),c.Qb(),c.Rb(19,"div",4),c.uc(20," Testing of experimental features. "),c.Qb(),c.Qb(),c.Qb())},styles:["[_nghost-%COMP%]{display:flex;flex:1 1 auto;flex-direction:row;justify-content:center;align-items:center}.destination[_ngcontent-%COMP%]{width:300px;height:400px;margin:8px;background:rgba(64,8,0,.55);box-shadow:0 16px 16px 4px #000}.destination[_ngcontent-%COMP%]:hover{background:rgba(175,16,0,.5);cursor:url(/edstory/assets/support/cursor_glow.png) 6 1,pointer}.disabled[_ngcontent-%COMP%]{cursor:default;opacity:.4}.image[_ngcontent-%COMP%]{width:100%;height:250px;margin-bottom:8px}.ship[_ngcontent-%COMP%]{background:url(/edstory/assets/ship/krait-mk-ii/center.png),url(/edstory/assets/location/station/hangar/center.png);background-size:cover;background-position:-64px;opacity:.7}.settings[_ngcontent-%COMP%]{background:url(/edstory/assets/backgrounds/cogs.jpg);background-size:cover;background-position:-32px;opacity:.7}.playground[_ngcontent-%COMP%]{background:url(/edstory/assets/backgrounds/experimental.jpg);background-size:cover;background-position:-32px;opacity:.7}.textbox[_ngcontent-%COMP%]{margin:16px}.title[_ngcontent-%COMP%]{margin-bottom:8px;color:#ff6105}.description[_ngcontent-%COMP%]{font-size:small;color:#fff;text-transform:none}"]}),r),p=n("4A+J"),f=n("OcQ2"),g=n("OEjf"),b=n("EY6u"),y=n("eihG");function m(e,t){1&e&&c.Mb(0,"ed-icon",3)}function v(e,t){1&e&&c.Mb(0,"ed-icon",4)}var k,_,C,w,x,P,M,O,S,I=["*"],A=((k=function(){function e(){_classCallCheck(this,e),this.state="active",this.checkedChange=new c.n}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"getCssClass",value:function(){var e=" checked";switch(this.checkedValue||(e=" unchecked"),this.state){case"active":return"container active"+e;case"selected":return"container selected"+e;case"disabled":return"container disabled"+e;case"blocked":return"container blocked"+e}}},{key:"onClick",value:function(){"active"===this.state&&(this.checked=!this.checked)}},{key:"checked",get:function(){return this.checkedValue},set:function(e){this.checkedValue=e,this.checkedChange.emit(e)}}]),e}()).\u0275fac=function(e){return new(e||k)},k.\u0275cmp=c.Fb({type:k,selectors:[["ed-check"]],inputs:{state:"state",checked:"checked"},outputs:{checkedChange:"checkedChange"},ngContentSelectors:I,decls:4,vars:3,consts:[[3,"ngClass","click"],["icon","checked","size","3",4,"ngIf"],["icon","unchecked","size","3",4,"ngIf"],["icon","checked","size","3"],["icon","unchecked","size","3"]],template:function(e,t){1&e&&(c.fc(),c.Rb(0,"div",0),c.Yb("click",(function(){return t.onClick()})),c.sc(1,m,1,0,"ed-icon",1),c.sc(2,v,1,0,"ed-icon",2),c.ec(3),c.Qb()),2&e&&(c.gc("ngClass",t.getCssClass()),c.Ab(1),c.gc("ngIf",t.checked),c.Ab(1),c.gc("ngIf",!t.checked))},directives:[o.h,o.j,y.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;margin-bottom:4px}.container[_ngcontent-%COMP%]{box-sizing:border-box;height:4vh;display:flex;flex-direction:row;align-items:center;padding-left:.5vw;font-size:1.7vh}ed-icon[_ngcontent-%COMP%]{margin-right:8px}.checked[_ngcontent-%COMP%]{color:#ff6105;stroke:#ff6105}.unchecked[_ngcontent-%COMP%]{color:rgba(187,44,0,.7);stroke:rgba(187,44,0,.7)}.active[_ngcontent-%COMP%]{background:rgba(64,8,0,.55)}.container.active[_ngcontent-%COMP%]:hover{background:#f07b05;color:#000}.selected[_ngcontent-%COMP%]{background:rgba(175,16,0,.5);color:#ff6105;border-right:8px solid #ff6105}.container.selected[_ngcontent-%COMP%]:hover{background:#f07b05;color:#000}.disabled[_ngcontent-%COMP%]{background:rgba(48,48,48,.69);color:#fff;stroke:#fff;fill:#fff}.blocked[_ngcontent-%COMP%]{background:rgba(56,0,0,.38);color:#ac0000;stroke:#ac0000;fill:#ac0000}.container.blocked[_ngcontent-%COMP%]:hover{background:#ac0000;color:#000;stroke:#000;fill:#000}"]}),k),L=n("65hZ"),T=((_=function(){function e(t){var n=this;_classCallCheck(this,e),this.commanderService=t,this.commanderService.features.subscribe((function(e){n.features=e}))}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"updateFeatures",value:function(){this.commanderService.features.next(this.features)}}]),e}()).\u0275fac=function(e){return new(e||_)(c.Lb(p.a))},_.\u0275cmp=c.Fb({type:_,selectors:[["ng-component"]],decls:23,vars:5,consts:[[1,"columns"],["name","Alternatives","description","Suggested improvements for game"],[3,"checked","checkedChange"],["state","blocked",3,"checked","checkedChange"],["name","Game features","description","Update based additions"]],template:function(e,t){1&e&&(c.Rb(0,"ed-window"),c.Rb(1,"div",0),c.Rb(2,"ed-column"),c.Mb(3,"ed-title",1),c.Rb(4,"h4"),c.uc(5,"Big changes"),c.Qb(),c.Rb(6,"ed-check",2),c.Yb("checkedChange",(function(e){return t.features.corporations=e}))("checkedChange",(function(){return t.updateFeatures()})),c.uc(7,"Corporations"),c.Qb(),c.Rb(8,"ed-check",3),c.Yb("checkedChange",(function(e){return t.features.advisors=e}))("checkedChange",(function(){return t.updateFeatures()})),c.uc(9,"Advisors"),c.Qb(),c.Rb(10,"ed-check",3),c.Yb("checkedChange",(function(e){return t.features.passengerLines=e}))("checkedChange",(function(){return t.updateFeatures()})),c.uc(11,"Passenger lines"),c.Qb(),c.Mb(12,"ed-frame-spacer"),c.Rb(13,"h4"),c.uc(14,"Small changes"),c.Qb(),c.Rb(15,"ed-check",3),c.Yb("checkedChange",(function(e){return t.features.navigationPanelAlternative=e}))("checkedChange",(function(){return t.updateFeatures()})),c.uc(16,"Navigation panel alternative"),c.Qb(),c.Qb(),c.Rb(17,"ed-column"),c.Mb(18,"ed-title",4),c.Rb(19,"h4"),c.uc(20,"June 2020"),c.Qb(),c.Rb(21,"ed-check",2),c.Yb("checkedChange",(function(e){return t.features.fleetCarriers=e}))("checkedChange",(function(){return t.updateFeatures()})),c.uc(22,"Fleet carriers"),c.Qb(),c.Qb(),c.Qb(),c.Qb()),2&e&&(c.Ab(6),c.gc("checked",t.features.corporations),c.Ab(2),c.gc("checked",t.features.advisors),c.Ab(2),c.gc("checked",t.features.passengerLines),c.Ab(5),c.gc("checked",t.features.navigationPanelAlternative),c.Ab(6),c.gc("checked",t.features.fleetCarriers))},directives:[f.a,g.a,b.a,A,L.a],styles:["[_nghost-%COMP%]{height:100%}.columns[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex;flex:1 1 auto;flex-direction:row}ed-column[_ngcontent-%COMP%]{width:50%;margin:1vw;padding:1vw}"]}),_),j=n("Womt"),R=function(){function e(){_classCallCheck(this,e),this.actual=new j.f,this.actual.userData=this}return _createClass(e,[{key:"linkToScene",value:function(e){e.add(this.actual)}},{key:"updateLod",value:function(e){this.lod!==e&&(this.lod=e,this.disposeResources(),this.applyLod(this.actual,this.lod))}},{key:"run",value:function(e){this.updateContext(this.actual,e)}},{key:"attach",value:function(e){this.actual.add(e.actual),e.updateLod(0)}},{key:"disposeResources",value:function(){var t,n=[],i=_createForOfIteratorHelper(this.actual.children);try{for(i.s();!(t=i.n()).done;){var r=t.value;r instanceof j.d&&(r.geometry.dispose(),r.material.dispose()),r.userData instanceof e&&n.push(r)}}catch(s){i.e(s)}finally{i.f()}this.actual.children=n}}],[{key:"AuToLs",value:function(e){return 499.004784*e}},{key:"KmToLs",value:function(e){return e/(3.33564095*Math.pow(10,6))}}]),e}(),E=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.apply(this,arguments)).$stars=[],e.$contacts=[],e}return _createClass(n,[{key:"addStar",value:function(e){this.attach(e),this.$stars.push(e)}},{key:"run",value:function(e){_get(_getPrototypeOf(n.prototype),"run",this).call(this,e);var t,i=_createForOfIteratorHelper(this.$stars);try{for(i.s();!(t=i.n()).done;){t.value.run(e)}}catch(o){i.e(o)}finally{i.f()}var r,s=_createForOfIteratorHelper(this.$contacts);try{for(s.s();!(r=s.n()).done;){r.value.run(e)}}catch(o){s.e(o)}finally{s.f()}}},{key:"applyLod",value:function(e,t){}},{key:"updateContext",value:function(e,t){}},{key:"stars",get:function(){return[].concat(this.$stars)}},{key:"contacts",get:function(){return[].concat(this.$contacts)}}]),n}(R),z=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.apply(this,arguments)).eccentricity=0,e.orbitalInclination=0,e.orbitalPeriod=1,e.$artificials=[],e}return _createClass(n,[{key:"addStation",value:function(e){this.attach(e),this.$artificials.push(e)}},{key:"addInstallation",value:function(e){this.attach(e),this.$artificials.push(e)}},{key:"run",value:function(e){_get(_getPrototypeOf(n.prototype),"run",this).call(this,e);var t,i=_createForOfIteratorHelper(this.artificials);try{for(i.s();!(t=i.n()).done;){t.value.run(e)}}catch(r){i.e(r)}finally{i.f()}}},{key:"applyLod",value:function(e,t){var n=new j.a(5,10),i=new j.e({color:"red"}),r=new j.d(n,i);r.position.z=5+this.radius,r.rotation.x=-.5*Math.PI,e.add(r)}},{key:"updateContext",value:function(e,t){var n=24*this.orbitalPeriod*60*60*1e3,i=t%n/n;console.log(i);var r=2*Math.PI*(i||0),s=Math.tan(.0174532925*this.orbitalInclination)*this.semiMajorAxis;e.position.x=Math.sin(r)*this.semiMajorAxis,e.position.y=Math.cos(r)*this.semiMajorAxis*(1-this.eccentricity),e.position.z=Math.sin(r)*s}},{key:"artificials",get:function(){return[].concat(this.$artificials)}}]),n}(R),H=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.apply(this,arguments)).$planets=[],e}return _createClass(n,[{key:"addPlanet",value:function(e){this.attach(e),this.$planets.push(e)}},{key:"run",value:function(e){_get(_getPrototypeOf(n.prototype),"run",this).call(this,e);var t,i=_createForOfIteratorHelper(this.planets);try{for(i.s();!(t=i.n()).done;){t.value.run(e)}}catch(r){i.e(r)}finally{i.f()}}},{key:"applyLod",value:function(e,t){_get(_getPrototypeOf(n.prototype),"applyLod",this).call(this,e,t);var i=new j.j(this.radius,25,25),r=new j.e({color:"yellow"}),s=new j.d(i,r);e.name=this.name,e.add(s)}},{key:"planets",get:function(){return[].concat(this.$planets)}}]),n}(z),B=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.apply(this,arguments)).$moons=[],e}return _createClass(n,[{key:"addMoon",value:function(e){this.attach(e),this.$moons.push(e)}},{key:"run",value:function(e){_get(_getPrototypeOf(n.prototype),"run",this).call(this,e);var t,i=_createForOfIteratorHelper(this.moons);try{for(i.s();!(t=i.n()).done;){t.value.run(e)}}catch(r){i.e(r)}finally{i.f()}}},{key:"applyLod",value:function(e,t){_get(_getPrototypeOf(n.prototype),"applyLod",this).call(this,e,t);var i=new j.j(this.radius,25,25),r=new j.e({color:"green"}),s=new j.d(i,r);e.add(s)}},{key:"moons",get:function(){return[].concat(this.$moons)}}]),n}(z),Q=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"applyLod",value:function(e,t){_get(_getPrototypeOf(n.prototype),"applyLod",this).call(this,e,t);var i=new j.j(this.radius,25,25),r=new j.e({color:"silver"}),s=new j.d(i,r);e.add(s)}}]),n}(z),F=((C=function(){function e(t){_classCallCheck(this,e),this.element=t,this.loader=new j.b,this.renderer=new j.l,this.scene=new j.i,this.camera=new j.g(60,window.innerWidth/window.innerHeight,1e-4,1e6),this.hud=new j.f}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.element.nativeElement.appendChild(this.renderer.domElement),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setAnimationLoop((function(){e.renderFrame()})),this.camera.position.z=100,this.camera.position.y=-150,this.camera.rotation.x=1,this.scene.background=this.loader.load(["/assets/backgrounds/space.jpg","/assets/backgrounds/space.jpg","/assets/backgrounds/space.jpg","/assets/backgrounds/space.jpg","/assets/backgrounds/space.jpg","/assets/backgrounds/space.jpg"])}},{key:"ngOnDestroy",value:function(){this.scene.dispose(),this.renderer.dispose()}},{key:"onResize",value:function(e){this.renderer.setSize(window.innerWidth,window.innerHeight),this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix()}},{key:"resetViewport",value:function(e){this.scene.children=[],e.linkToScene(this.scene)}},{key:"applyGamepadStateToMapCamera",value:function(e){var t=new j.k;this.camera.getWorldDirection(t),t.z=0,this.camera.position.addScaledVector(t,e.leftStickAxisY*(5/this.camera.zoom)),t.applyAxisAngle(new j.k(0,0,1),.5*Math.PI),this.camera.position.addScaledVector(t,5/this.camera.zoom*-e.leftStickAxisX),this.camera.rotateOnWorldAxis(new j.k(0,0,1),-e.rightStickAxisX/(50*this.camera.zoom)),this.camera.rotateOnWorldAxis(t,-e.rightStickAxisY/(50*this.camera.zoom)),e.leftTrigger&&(this.camera.zoom=1,this.camera.updateProjectionMatrix()),e.rightTrigger&&(this.camera.zoom+=this.camera.zoom/50,this.camera.updateProjectionMatrix())}},{key:"renderFrame",value:function(){this.tick=Date.now(),this.run(this.tick),this.renderer.render(this.scene,this.camera)}},{key:"updateHud",value:function(){this.hud.children=[];var e=new j.h(5,5,1,1),t=new j.e({color:"blue",opacity:.5,transparent:!0,side:j.c}),n=new j.d(e,t);this.hud.add(n);var i=new j.k,r=new j.k;this.camera.getWorldDirection(i),this.camera.getWorldPosition(r),this.hud.position.copy(this.camera.position),this.hud.position.addScaledVector(i,5),this.hud.rotation.copy(this.camera.rotation)}}]),e}()).\u0275fac=function(e){return new(e||C)(c.Lb(c.l))},C.\u0275dir=c.Gb({type:C,hostBindings:function(e,t){1&e&&c.Yb("resize",(function(e){return t.onResize(e)}),!1,c.mc)}}),C),Y=n("PqYM"),$=function(e){return e[e.Inactive=0]="Inactive",e[e.Click=2]="Click",e[e.Hold=3]="Hold",e}({}),V=function(){function e(){_classCallCheck(this,e),this.buttonTick=[],this.buttonA=$.Inactive,this.buttonB=$.Inactive,this.buttonX=$.Inactive,this.buttonY=$.Inactive,this.leftBumper=$.Inactive,this.rightBumper=$.Inactive,this.leftStick=$.Inactive,this.rightStick=$.Inactive,this.dPadUp=$.Inactive,this.dPadRight=$.Inactive,this.dPadDown=$.Inactive,this.dPadLeft=$.Inactive}return _createClass(e,[{key:"apply",value:function(e,t){if(this.userInput=!1,this.buttonTick.length!==e.buttons.length){this.buttonTick=[];var n,i=_createForOfIteratorHelper(e.buttons);try{for(i.s();!(n=i.n()).done;){n.value;this.buttonTick.push(void 0)}}catch(r){i.e(r)}finally{i.f()}}this.buttonA=this.processButton(0,e,t),this.buttonB=this.processButton(1,e,t),this.buttonX=this.processButton(2,e,t),this.buttonY=this.processButton(3,e,t),this.leftBumper=this.processButton(4,e,t),this.rightBumper=this.processButton(5,e,t),this.leftStick=this.processButton(10,e,t),this.rightStick=this.processButton(11,e,t),this.dPadUp=this.processButton(12,e,t),this.dPadRight=this.processButton(13,e,t),this.dPadDown=this.processButton(14,e,t),this.dPadLeft=this.processButton(15,e,t),this.leftTrigger=this.processButtonValue(6,e),this.rightTrigger=this.processButtonValue(7,e),this.leftStickAxisX=this.processAxis(0,e,!1),this.leftStickAxisY=this.processAxis(1,e,!0),this.rightStickAxisX=this.processAxis(2,e,!1),this.rightStickAxisY=this.processAxis(3,e,!0)}},{key:"processButton",value:function(e,t,n){if(e>=t.buttons.length)return $.Inactive;if(void 0===this.buttonTick[e])t.buttons[e].pressed&&(this.buttonTick[e]=n);else if(t.buttons[e].pressed){if(n-this.buttonTick[e]>30)return this.userInput=!0,$.Hold}else{if(n-this.buttonTick[e]<=30)return this.userInput=!0,this.buttonTick[e]=void 0,$.Click;this.buttonTick[e]=void 0}return $.Inactive}},{key:"processButtonValue",value:function(e,t){return e>=t.buttons.length?0:t.buttons[e].value>.1?(this.userInput=!0,t.buttons[e].value):0}},{key:"processAxis",value:function(e,t,n){return e>=t.axes.length?0:Math.abs(t.axes[e])>.1?(this.userInput=!0,n?-t.axes[e]:t.axes[e]):0}}]),e}(),D=((w=function(){function e(){var t=this;_classCallCheck(this,e),this.controller1=new c.n,this.gamepadState=new V,this.tick=0,window.addEventListener("gamepadconnected",(function(e){t.gamepad=e.gamepad,t.processState()})),window.addEventListener("gamepaddisconnected",(function(e){t.gamepad=void 0}))}return _createClass(e,[{key:"processState",value:function(){var e=this;this.gamepad&&(this.gamepad=navigator.getGamepads()[this.gamepad.index],this.tick+=1,this.gamepadState.apply(this.gamepad,this.tick),this.gamepadState.userInput&&this.controller1.next(this.gamepadState),Object(Y.a)(16.67).subscribe((function(){return e.processState()})))}}]),e}()).\u0275fac=function(e){return new(e||w)},w.\u0275prov=c.Hb({token:w,factory:w.\u0275fac,providedIn:"root"}),w),W=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"applyMouse",value:function(e,t){this.deltaX=e.clientX-this.x,this.deltaY=e.clientY-this.y,this.x=e.clientX,this.y=e.clientY,(this.deltaX||this.deltaY)&&(this.userInput=!0)}},{key:"applyWheel",value:function(e,t){this.deltaZ=e.deltaY,this.deltaZ&&(this.userInput=!0)}}]),e}(),X=((P=function(){function e(){_classCallCheck(this,e),this.state=new c.n,this.keyMouseState=new W,this.tick=0}return _createClass(e,[{key:"attach",value:function(e){var t=this;this.domElement&&(this.domElement.removeEventListener("mousemove",(function(e){t.mouseHandler(e)})),this.domElement.removeEventListener("mousedown",(function(e){t.mouseHandler(e)})),this.domElement.removeEventListener("mouseup",(function(e){t.mouseHandler(e)})),this.domElement.removeEventListener("wheel",(function(e){t.wheelHandler(e)}))),this.domElement=e,this.domElement.addEventListener("mousemove",(function(e){t.mouseHandler(e)})),this.domElement.addEventListener("mousedown",(function(e){t.mouseHandler(e)})),this.domElement.addEventListener("mouseup",(function(e){t.mouseHandler(e)})),this.domElement.addEventListener("wheel",(function(e){t.wheelHandler(e)})),this.processState()}},{key:"mouseHandler",value:function(e){this.keyMouseState.applyMouse(e,this.tick)}},{key:"wheelHandler",value:function(e){this.keyMouseState.applyWheel(e,this.tick)}},{key:"processState",value:function(){var e=this;this.tick+=1,this.keyMouseState.userInput&&(this.state.emit(this.keyMouseState),this.keyMouseState.userInput=!1),Object(Y.a)(16.67).subscribe((function(){return e.processState()}))}}]),e}()).\u0275fac=function(e){return new(e||P)},P.\u0275prov=c.Hb({token:P,factory:P.\u0275fac,providedIn:"root"}),P),K=((x=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,r){var s;return _classCallCheck(this,n),(s=t.call(this,e)).gamepadService=i,s.keyMouseService=r,s.mode="map",s.keyMouseService.attach(e.nativeElement),s.keyMouseService.state.subscribe((function(e){})),s.gamepadService.controller1.subscribe((function(e){switch(s.mode){case"map":s.applyGamepadStateToMapCamera(e)}})),s}return _createClass(n,[{key:"run",value:function(e){this.starSystem&&this.starSystem.run(e)}},{key:"starSystem",get:function(){return this.$starSystem},set:function(e){this.$starSystem=e,this.resetViewport(this.$starSystem)}}]),n}(F)).\u0275fac=function(e){return new(e||x)(c.Lb(c.l),c.Lb(D),c.Lb(X))},x.\u0275cmp=c.Fb({type:x,selectors:[["space-viewport-system"]],inputs:{mode:"mode",starSystem:"starSystem"},features:[c.xb],decls:0,vars:0,template:function(e,t){},styles:["[_nghost-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden}"]}),x),J=[{path:"",component:h,children:[{path:"",component:d},{path:"tinkering",component:T},{path:"playground",component:(M=function(){function e(){_classCallCheck(this,e),this.starSystem=new E,this.starSystem.name="Sol";var t=new H;t.name="sol",t.radius=H.KmToLs(696340),t.orbitalPeriod=0,t.semiMajorAxis=0,t.orbitalInclination=0,t.radius=H.KmToLs(696340);var n=new B;n.name="Mercury",n.radius=B.KmToLs(4878),n.semiMajorAxis=B.AuToLs(.39),n.eccentricity=.0167086,n.orbitalPeriod=87.9691,n.orbitalInclination=7.005,t.addPlanet(n);var i=new B;i.name="Venus",i.radius=B.KmToLs(12104),i.semiMajorAxis=B.AuToLs(.72),i.eccentricity=.0167086,i.orbitalPeriod=224.701,i.orbitalInclination=3.39458,t.addPlanet(i);var r=new B;r.name="Earth",r.radius=B.KmToLs(6378.1),r.semiMajorAxis=B.AuToLs(1.00000102),r.eccentricity=.0167086,r.orbitalPeriod=365.256363004,r.orbitalInclination=7.155,r.rotationPeriod=.99726968,r.axialTilt=23.4392811,r.periapsis=288.1,t.addPlanet(r);var s=new Q;s.name="Moon",s.radius=Q.KmToLs(6378.1),s.semiMajorAxis=Q.KmToLs(384399),s.eccentricity=.0549,s.orbitalPeriod=27.321661,s.orbitalInclination=5.145,s.rotationPeriod=27.321661,s.axialTilt=24,r.addMoon(s);var o=new B;o.name="Mars",o.radius=B.KmToLs(6794),o.semiMajorAxis=B.AuToLs(1.52),o.eccentricity=.006772,o.orbitalPeriod=686.98,o.orbitalInclination=3.39458,t.addPlanet(o),this.starSystem.addStar(t)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}(),M.\u0275fac=function(e){return new(e||M)},M.\u0275cmp=c.Fb({type:M,selectors:[["ng-component"]],decls:1,vars:1,consts:[[3,"starSystem"]],template:function(e,t){1&e&&c.Mb(0,"space-viewport-system",0),2&e&&c.gc("starSystem",t.starSystem)},directives:[K],styles:["[_nghost-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column;margin:64px}.instruction[_ngcontent-%COMP%]{position:absolute;left:16px;top:16px;border:2px solid rgba(187,44,0,.5);background:repeating-linear-gradient(0deg,rgba(0,0,0,.55),rgba(0,0,0,.55) 4px,rgba(64,4,0,.25) 0,rgba(0,0,0,.55) 6px),rgba(0,0,0,.35);padding:8px;z-index:10}"]}),M)}]}],G=((S=function e(){_classCallCheck(this,e)}).\u0275mod=c.Jb({type:S}),S.\u0275inj=c.Ib({factory:function(e){return new(e||S)},imports:[[l.d.forChild(J)],l.d]}),S),N=((O=function e(){_classCallCheck(this,e)}).\u0275mod=c.Jb({type:O}),O.\u0275inj=c.Ib({factory:function(e){return new(e||O)},imports:[[o.b,u,a.a,G]]}),O)}}]);